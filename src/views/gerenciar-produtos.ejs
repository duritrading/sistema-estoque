<%- include('partials/header', {
  titulo: 'Gerenciar Produtos',
  subtitulo: 'AdministraÃ§Ã£o e controle de produtos',
  user: locals.user
}) %>

<div class="card">
  <h2>ðŸ“‹ Produtos Cadastrados (<%= produtos.length %>)</h2>
  <table class="table">
    <thead>
      <tr>
        <th>CÃ³digo</th>
        <th>DescriÃ§Ã£o</th>
        <th>Categoria</th>
        <th>Unidade</th>
        <th>Saldo Atual</th>
        <th>Estoque MÃ­n.</th>
        <th>PreÃ§o Custo</th>
        <th>MovimentaÃ§Ãµes</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <% produtos.forEach(p => { %>
        <tr>
          <td><strong><%= p.codigo %></strong></td>
          <td><%= p.descricao %></td>
          <td><%= p.categoria || '-' %></td>
          <td><%= p.unidade || 'UN' %></td>
          <td class="<%= p.saldo_atual > 0 ? 'saldo-positivo' : p.saldo_atual === 0 ? 'saldo-zero' : 'saldo-negativo' %>"><%= p.saldo_atual %></td>
          <td><%= p.estoque_minimo || 0 %></td>
          <td><%= p.preco_custo ? 'R$ ' + parseFloat(p.preco_custo).toLocaleString('pt-BR', {minimumFractionDigits: 2}) : '-' %></td>
          <td><%= p.total_movimentacoes || 0 %></td>
          <td>
            <% if (p.saldo_atual <= (p.estoque_minimo || 0)) { %>
              <span class="badge badge-warning">Estoque Baixo</span>
            <% } else { %>
              <span class="badge badge-success">Normal</span>
            <% } %>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<%- include('partials/footer') %>